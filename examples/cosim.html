<!DOCTYPE html>
<html>
<head>
    <title>p2.js</title>
    <script src="../build/p2.js"></script>
    <script src="http://code.jquery.com/jquery-1.10.0.min.js"></script>
    <script src="pixi.js"></script>
    <script src="Demo.js"></script>
    <script src="PixiDemo.js"></script>
    <link href="demo.css" rel="stylesheet"/>
</head>
<body>
    <script>

        var world = new p2.World({
            doProfiling : true,
            gravity : [0,-5]
        });

        var bodies = [];
        var N=10,
            timeStep = 1/60,
            k=1000,
            d=10,
            l=0.35,
            m=1;

        // Create particles
        var particleShape = new p2.Particle();
        for(var i=0; i<N; i++){
            var p = new p2.Body({
                mass: i==N-1 ? 0 : m,
                position : [0, (i-N/2)*l*1.05]
            });
            p.addShape(particleShape);
            bodies.push(p);
            world.addBody(p);
        }

        // Springs
        for(var i=0; i<N-1; i++){
            var bodyA = bodies[i];
            var bodyB = bodies[i+1];
            var spring = new p2.Spring(bodyA,bodyB, {
                stiffness: k,
                restLength: l,
                damping : d
            });
            world.addSpring(spring);
        }

        var demo = new PixiDemo(world);

        function update(){
            if(!demo.paused)
                world.step(1/60);
            requestAnimationFrame(update);
        }
        requestAnimationFrame(update);

    </script>
</bodyBody>
</html>
