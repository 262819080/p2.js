<!DOCTYPE html>
<html>
<head>
    <title>spring2d.js</title>
    <script src="demo.js"></script>
    <link href="demo.css" rel="stylesheet"/>
    <script src="../spring2d.js"></script>
</head>
<body>
    <script>
        demo.createScene(function(world){
            var particles = [];
            var l = 20, N=10, M=10;
            var timeStep = 1/60,
                k=500,
                d=10,
                l=1,
                m=1;
            world.gravity.set(0,1);

            // Create particles
            var shape = new Spring2D.Particle();
            for(var i=0; i<N; i++){
                particles.push([]);
                for(var j=0; j<M; j++){
                    var p = new Spring2D.Body(i==0 ? 0 : m, shape);
                    p.position.set(i*l*1.05,j*l*1.05);
                    particles[i].push(p);
                    world.addBody(p);
                }
            }

            // Vertical
            for(var i=0; i<N; i++){
                for(var j=0; j<M-1; j++){
                    var a = particles[i][j];
                    var b = particles[i][j+1];
                    var spring = new Spring2D.Spring(a,b);
                    spring.stiffness = k;
                    world.addSpring(spring);
                    spring.restLength = l;
                }
            }
            // Horizontal
            for(var i=0; i<N-1; i++){
                for(var j=0; j<M; j++){
                    var a = particles[i][j];
                    var b = particles[i+1][j];
                    var spring = new Spring2D.Spring(a,b);
                    spring.stiffness = k;
                    world.addSpring(spring);
                    spring.restLength = l;
                }
            }
            // Diagonal right/down
            for(var i=0; i<N-1; i++){
                for(var j=0; j<M-1; j++){
                    var a = particles[i][j];
                    var b = particles[i+1][j+1];
                    var spring = new Spring2D.Spring(a,b);
                    spring.stiffness = k;
                    world.addSpring(spring);
                    spring.restLength = Math.sqrt(l*l + l*l);
                }
            }
            // Diagonal left/down
            for(var i=0; i<N-1; i++){
                for(var j=0; j<M-1; j++){
                    var a = particles[i+1][j];
                    var b = particles[i][j+1];
                    var spring = new Spring2D.Spring(a,b);
                    spring.stiffness = k;
                    world.addSpring(spring);
                    spring.restLength = Math.sqrt(l*l + l*l);
                }
            }
        });        
    </script>
</body>
</html>
